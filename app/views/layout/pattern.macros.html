{% from 'nightshade-core/src/buttons/buttons.macros.html' import button %}

{% macro github_link(path) %}
<a href="https://github.com/CasperSleep/nightshade-core/tree/master{{ path }}">View on GitHub</a>
{% endmacro %}

{% macro rules_list(rules) %}
<ul class="pattern-rules-list">
  <li class="pattern-rules-list-item">
    <h4 class="heading--smallcaps-light">Typography</h4>
    <p>{{ rules.typography }}</p>
  </li>
  <li class="pattern-rules-list-item">
    <h4 class="heading--smallcaps-light">Specs &amp; Dimensions</h4>
    <p>{{ rules.specs }}</p>
  </li>
  <li class="pattern-rules-list-item">
    <h4 class="heading--smallcaps-light">Color &amp; Accessibility</h4>
    <p>{{ rules.color }}</p>
  </li>
</ul>
{% endmacro %}

{% macro rules_examples(examples) %}
<div class="pattern-rules-examples">
  {% for example in examples %}
    <div class="pattern-rules-example">
      <div class="pattern-example-display r-centered">
        {{ example.html|safe }}
      </div>
      <p>
        <strong class="heading--smallcaps-light">DON'T</strong>
        {{ example.description }}
      </p>
    </div>
  {% endfor %}
</div>
{% endmacro %}

{% macro import_block(type, imports) %}
<section class="pattern-usage-header">
  <h4 class="heading--smallcaps-light">Import {{ type }}</h4>
  <div class="pattern-usage-header-actions">
    {{ github_link(imports.path) }}
  </div>
</section>

<pre class="pattern-usage-code"><code>{{ imports.code }}</code></pre>
{% endmacro %}

{% macro variant_item(variant) %}
<p class="pattern-variant-description">{{ variant.description }}</p>

{% if variant.html or variant.rules %}
  <div class="pattern-example">
    {% if variant.html %}
      <div class="pattern-example-display r-centered">
        {{ variant.html|safe }}
      </div>
    {% endif %}

    {% if variant.rules or variant.examples%}
      <div class="pattern-rules">
        {{ rules_list(variant.rules) }}

        {% if variant.examples %}
          {{ rules_examples(variant.examples) }}
        {% endif %}
      </div>
    {% endif %}
  </div>
{% endif %}

<div class="pattern-usage">

  {% if macro or html %}
    <header class="pattern-usage-header">
      <h4 class="heading--smallcaps-light">Code Example</h4>
      <div class="pattern-usage-header-actions">
        <div class="pattern-usage-toggles">
          <button class="pattern-usage-toggle is-selected js-show-macro">Macro</button>
          <button class="pattern-usage-toggle js-show-html">HTML</button>
        </div>
      </div>
    </header>
    <pre class="pattern-usage-code js-code-macro"><code>{{ macro }}</code></pre>
    <pre class="pattern-usage-code is-hidden js-code-html"><code>{{ html }}</code></pre>
  {% endif %}

  {% if variant.imports.stylesheet %}
    {{ import_block('Stylesheet', variant.imports.stylesheet) }}
  {% endif %}

  {% if variant.imports.macro %}
    {{ import_block('Macro', variant.imports.macro) }}
  {% endif %}

  {% if variant.imports.javascript %}
    {{ import_block('JavaScript', variant.imports.javascript) }}
  {% endif %}

  {% if variant.tech_notes %}
    {% markdown variant.tech_notes | string  %}
  {% endif %}
</div>
{% endmacro %}

{% macro variant(variant) %}
<article class="pattern-variant" id="{{ variant.name|lower|replace(' ', '-') }}">
  <h2 class="heading--secondary-light">{{ variant.name }}</h2>

  {% if variant.modifiers %}
    {% for modifier in variant.modifiers %}
        <h3 class="heading--tertiary-light">{{ modifier.name }}</h3>
        {{ variant_item(modifier) }}
    {% endfor %}
  {% else %}
    {{ variant_item(variant) }}
  {% endif %}
</article>
{% endmacro %}
