{% from 'nightshade-core/src/buttons/buttons.macros.html' import button %}

{% macro github_link(path) %}
<a href="https://github.com/CasperSleep/nightshade-core/tree/v2.0.0-dev/{{ path }}">View on GitHub</a>
{% endmacro %}

{% macro rules_list(list) %}
<ul class="pattern-rules-list">
  <li class="pattern-rules-list-item">
    <h4>Typography</h4>
    <p>{{ list.typography }}</p>
  </li>
  <li class="pattern-rules-list-item">
    <h4>Specs &amp; Dimensions</h4>
    <p>{{ list.specs }}</p>
  </li>
  <li class="pattern-rules-list-item">
    <h4>Color &amp; Accessibility</h4>
    <p>{{ list.color }}</p>
  </li>
</ul>
{% endmacro %}

{% macro rules_examples(examples) %}
<div class="pattern-rules-examples">
  {% for example in examples %}
  <div class="pattern-rules-example">
    <div class="pattern-example-display r-centered">
      {{ example.html|safe }}
    </div>
    <p>{{ example.description }}</p>
  </div>
  {% endfor %}
</div>
{% endmacro %}

{% macro notes_list(notes) %}
<ul class="pattern-notes">
  {% for note in notes %}
  <li>{{ note|safe }}</li>
  {% endfor %}
</ul>
{% endmacro %}

{% macro import_block(type, path, code) %}
<header class="pattern-usage-header">
  <h4>Import {{ type }}</h4>
  <div class="pattern-usage-header-actions">
    {{ github_link(path) }}
  </div>
</header>
<pre class="pattern-usage-import"><code>{{ code }}</code></pre>
{% endmacro %}

{% macro variant_item(description, macro, html, rules=null, tech_notes=null, stylesheet_import=null, macro_import=null) %}
<p class="pattern-variant-description">{{ description }}</p>
<div class="pattern-example">
  <div class="pattern-example-display r-centered">
    {{ html|safe }}
  </div>

  {% if rules %}
  <div class="pattern-rules">
    {% if rules.list %}
    {{ rules_list(rules.list) }}
    {% endif %}

    {% if rules.examples %}
    {{ rules_examples(rules.examples) }}
    {% endif %}
  </div>
  {% endif %}
</div>

<div class="pattern-usage">
  <header class="pattern-usage-header">
    <h4>Code Example</h4>
    <div class="pattern-usage-header-actions">
      <div class="pattern-usage-toggles">
        <button class="pattern-usage-toggle is-selected js-show-macro">Macro</button>
        <button class="pattern-usage-toggle js-show-html">HTML</button>
      </div>
    </div>
  </header>
  <pre class="pattern-usage-code js-code-macro"><code>{{ macro }}</code></pre>
  <pre class="pattern-usage-code is-hidden js-code-html"><code>{{ html }}</code></pre>

  {% if tech_notes %}
  <h4>Usability Parameters</h4>
  {{ notes_list(tech_notes) }}
  {% endif %}

  {% if stylesheet_import %}
  {{ import_block('Stylesheet', stylesheet_import.path, stylesheet_import.code) }}
  {% endif %}

  {% if macro_import %}
  {{ import_block('Macro', macro_import.path, macro_import.code) }}
  {% endif %}
</div>
{% endmacro %}

{% macro variant(variant) %}
<section class="pattern-variant" id="{{ variant.name|lower|replace(' ', '-') }}">
  <h2>{{ variant.name }}</h2>

  {% if variant.modifiers %}
    {% for modifier in variant.modifiers %}
    <h3>{{ modifier.name }}</h3>
    {{ variant_item(modifier.description, modifier.macro, modifier.html, modifier.rules, modifier.tech_notes, modifier.stylesheet_import, modifier.macro_import) }}
    {% endfor %}
  {% else %}
    {{ variant_item(variant.description, variant.macro, variant.html, variant.rules, variant.tech_notes, variant.stylesheet_import, variant.macro_import) }}
  {% endif %}
</section>
{% endmacro %}
